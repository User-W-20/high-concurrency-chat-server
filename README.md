# C++ 高并发模块化聊天室 (LiteChat)

## 📖 项目简介

LiteChat 是一个基于 **C++** 的多人聊天室项目，旨在通过实践深入理解现代操作系统中的 **高并发网络编程** 与 **多线程模型**。

服务器端采用 **epoll + 线程池** 架构，能够高效处理大量并发客户端连接。
项目结构模块化，核心逻辑与功能模块解耦，便于扩展和维护。

---

## ✨ 功能特点

### 💻 架构设计

* **模块化管理**：服务器核心逻辑与群组功能独立，通过 `GroupManager` 管理群组。
* **高可扩展性**：支持快速新增功能而不影响主循环。

### 📡 高并发网络模型

* **非阻塞 I/O**：基于 epoll 统一监听所有客户端事件，高效处理并发连接。
* **线程池支持**：预创建工作线程，避免频繁创建/销毁线程，将 I/O 事件和耗时任务分离。

### 👤 用户管理

* **昵称系统**：首次连接需设置唯一昵称，自动检测冲突。
* **心跳检测**：超过 60 秒未活动的客户端将被断开并回收资源。

### 🗣 核心功能

* **广播消息**：公共消息带昵称并广播给所有在线用户。
* **群组聊天 (NEW)**：支持用户创建、加入群组，群内消息隔离。
* **私聊功能**：`/w <昵称> <消息>` 点对点私密通信。

### 🛡 管理员模式

* **身份验证**：管理员通过一次性口令（默认 `admin123`）验证身份。
* **踢人功能**：`/kick <昵称>` 踢出指定用户。

---

## 📋 命令支持

| 命令                                    | 描述         | 权限   |
| ------------------------------------- | ---------- | ---- |
| `/list`                               | 查看当前所有在线用户 | 所有用户 |
| `/list_groups`                        | 查看所有已创建的群组 | 所有用户 |
| `/create <群名>`                        | 创建新群组并自动加入 | 所有用户 |
| `/join <群名>`                          | 加入指定群组     | 所有用户 |
| `/send <群名> <消息>`                     | 向群组内发送消息   | 群组成员 |
| `/w <昵称> <消息>` 或 `/whisper <昵称> <消息>` | 发送私聊消息     | 所有用户 |
| `/kick <昵称>`                          | 踢出用户       | 管理员  |
| `/quit`                               | 退出聊天室      | 所有用户 |

---

## 🚀 使用方法

### 构建项目

```bash
mkdir build && cd build
cmake ..
make
```

### 启动服务端

```bash
./server
```

### 启动客户端

打开多个终端窗口，运行：

```bash
./client
```

* 首次连接输入昵称即可加入。
* 输入预设口令（默认 `admin123`）即可成为管理员。

---

## 💬 示例交互

```
张三 加入聊天室
李四 加入聊天室

张三: /create DevTeam
=> 群 'DevTeam' 创建成功，您已加入。

李四: /join DevTeam
=> 您已成功加入群 'DevTeam'

张三: /send DevTeam 大家好，我是群主！
=> [DevTeam]张三: 大家好，我是群主！（群内广播）

张三: /w 李四 你好
=> 张三 收到：已向 李四 发送私聊消息。
=> 李四 收到：来自 张三 的私聊：你好

管理员: /kick 张三
=> 张三 被踢出聊天室
```

---

## 📝 TODO / 改进方向

* **消息持久化**：将聊天记录写入日志文件。
* **协议升级**：引入 JSON 协议，支持更复杂的消息结构。
* **客户端优化**：开发 GUI 或 WebSocket 版本客户端。
